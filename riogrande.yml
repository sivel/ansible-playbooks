---
- hosts: riogrande
  become: true
  tasks:
    - file:
        path: /var/www/ansible.sivel.net
        state: directory
        owner: sivel
        group: sivel
        mode: 0755

    - import_role:
        role:
          name: docker
          docker_users:
            - sivel
      tags:
        - docker

    - import_role:
        role:
          name: prtriage
          github_client_id: !vault |
              $ANSIBLE_VAULT;1.1;AES256
              36623232646465623632346663363561613835363866383466313332326666383861386166373733
              3432316262333338626332383632346134666637363533610a643830643166633263343465373465
              62623231373763346366303139646566306436323538393635643666656136393836383935373439
              6365613933623730390a633538656139323066373261333066373766363737386461363264386366
              35383265323064623865383739346163373865623939333766636430333261663831
          github_client_secret: !vault |
              $ANSIBLE_VAULT;1.1;AES256
              34336439646536353838383164366166663761333030376163383036303566303432343335656433
              6432663536366333646635626539663232623132396239350a643062653230343162613738373766
              64326465643932363935373161363239353432626234353134356230353463343434363039396461
              6237376330313330340a336538626437373962313863666332623764313965653633346632663038
              39646434613864353863626139363231326336633163343462326335663932613631316262643133
              6465326161663833663133323431336436646261366434656265
      become: false
      tags:
        - prtriage

    - import_role:
        role:
          name: ansible-template-ui
          docker_hub_trigger_token: !vault |
              $ANSIBLE_VAULT;1.1;AES256
              61346530396265326531303537373666383138363765343464633361643165366537343839373039
              3732643163383939316230383235336564353261653562610a633263343465653936313836663931
              37303961666631316435616234653935396238306565653736653434363738613665316537363062
              3634396530313231360a306562346530666137656335303863393863326363306434353937353938
              33383133616231393638663630356663353433336432313361653235623531613230323937663466
              6336336434656335656531383935636165363762393632626464
      become: false
      tags:
        - ansible-template-ui

    - import_role:
        role:
          name: caddy
          caddyfile: "{{ playbook_dir }}/files/riogrande/Caddyfile"
          caddy_plugins:
            - http.git
      tags:
        - caddy
